# n8n Configuration for CraigLeads Pro
# This file contains environment variables for n8n workflow automation

###############################################################################
# n8n Server Configuration
###############################################################################

N8N_ENABLED=true
N8N_URL=http://localhost:5678
N8N_WEBHOOK_URL=http://localhost:5678/webhook
N8N_HOST=localhost
N8N_PORT=5678
N8N_PROTOCOL=http

###############################################################################
# n8n Authentication
###############################################################################

# IMPORTANT: Change these credentials after first login!
N8N_BASIC_AUTH_ACTIVE=true
N8N_BASIC_AUTH_USER=admin
N8N_BASIC_AUTH_PASSWORD=changeme

# API Key for programmatic access
N8N_API_KEY=your_n8n_api_key_here

###############################################################################
# Database Configuration
###############################################################################

# PostgreSQL for n8n data persistence
N8N_DB_TYPE=postgresdb
N8N_DB_HOST=postgres
N8N_DB_PORT=5432
N8N_DB_DATABASE=n8n
N8N_DB_USER=n8n
N8N_DB_PASSWORD=n8n_password

# Schema and SSL
DB_POSTGRESDB_SCHEMA=public
DB_POSTGRESDB_SSL_CA=
DB_POSTGRESDB_SSL_CERT=
DB_POSTGRESDB_SSL_KEY=
DB_POSTGRESDB_SSL_REJECT_UNAUTHORIZED=false

###############################################################################
# Execution Configuration
###############################################################################

EXECUTIONS_PROCESS=main
EXECUTIONS_MODE=regular
EXECUTIONS_TIMEOUT=3600
EXECUTIONS_TIMEOUT_MAX=7200
EXECUTIONS_DATA_SAVE_ON_ERROR=all
EXECUTIONS_DATA_SAVE_ON_SUCCESS=all
EXECUTIONS_DATA_SAVE_MANUAL_EXECUTIONS=true
EXECUTIONS_DATA_PRUNE=true
EXECUTIONS_DATA_MAX_AGE=336  # 14 days in hours

###############################################################################
# Queue Configuration (Redis)
###############################################################################

QUEUE_BULL_REDIS_HOST=redis
QUEUE_BULL_REDIS_PORT=6379
QUEUE_BULL_REDIS_DB=0
QUEUE_BULL_REDIS_PASSWORD=

###############################################################################
# Webhook Configuration
###############################################################################

# Backend webhook URLs (for n8n to call our API)
BACKEND_WEBHOOK_URL=http://host.docker.internal:8000/api/v1/n8n-webhooks
BACKEND_API_URL=http://host.docker.internal:8000/api/v1

# Webhook base URL (external URL if behind reverse proxy)
WEBHOOK_URL=http://localhost:5678/

###############################################################################
# n8n Features and Settings
###############################################################################

# Timezone
GENERIC_TIMEZONE=America/Los_Angeles

# Logging
N8N_LOG_LEVEL=info
N8N_LOG_OUTPUT=console

# Custom nodes directory
N8N_CUSTOM_EXTENSIONS=/home/node/.n8n/custom

# Enable/disable features
N8N_DISABLE_UI=false
N8N_HIRING_BANNER_ENABLED=false
N8N_TEMPLATES_ENABLED=true
N8N_TEMPLATES_HOST=https://api.n8n.io/api/
N8N_PERSONALIZATION_ENABLED=true
N8N_VERSION_NOTIFICATIONS_ENABLED=true

# API
N8N_API_ENABLED=true
N8N_METRICS=true
N8N_METRICS_INCLUDE_DEFAULT_METRICS=true
N8N_METRICS_INCLUDE_WORKFLOW_ID_LABEL=true
N8N_METRICS_INCLUDE_NODE_TYPE_LABEL=true

# Editor base URL (for webhooks and external access)
N8N_EDITOR_BASE_URL=http://localhost:5678

# Skip setup on first run (for automated deployments)
N8N_SKIP_SETUP=false

###############################################################################
# Security Configuration
###############################################################################

# Encryption key for credentials (generate with: openssl rand -hex 32)
N8N_ENCRYPTION_KEY=change_this_to_random_32_character_hex

# JWT secret for API authentication
N8N_JWT_SECRET=change_this_to_random_jwt_secret

# User management
N8N_USER_MANAGEMENT_DISABLED=false
N8N_EMAIL_MODE=smtp

###############################################################################
# Email Configuration (for notifications and user management)
###############################################################################

N8N_SMTP_HOST=smtp.gmail.com
N8N_SMTP_PORT=587
N8N_SMTP_USER=your_email@gmail.com
N8N_SMTP_PASS=your_app_password
N8N_SMTP_SENDER=noreply@craigleadspro.com
N8N_SMTP_SSL=false

###############################################################################
# Integration with CraigLeads Pro Backend
###############################################################################

# Backend API endpoint
CRAIGLEADS_API_URL=http://host.docker.internal:8000
CRAIGLEADS_API_KEY=your_backend_api_key

# Frontend URL (for notifications and links)
CRAIGLEADS_FRONTEND_URL=http://localhost:3000

###############################################################################
# Workflow-Specific Configuration
###############################################################################

# Lead processing workflow settings
LEAD_APPROVAL_REQUIRED=true
LEAD_MIN_SCORE=60
LEAD_AUTO_APPROVE_SCORE=85

# Demo site generation settings
DEMO_GENERATION_ENABLED=true
DEMO_AUTO_DEPLOY=false

# Video creation settings
VIDEO_GENERATION_ENABLED=true
VIDEO_MAX_DURATION=60

# Email outreach settings
EMAIL_ENABLED=true
EMAIL_DAILY_LIMIT=50
EMAIL_THROTTLE_MS=5000

###############################################################################
# Monitoring and Alerting
###############################################################################

# Slack notifications
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
SLACK_CHANNEL=#craigleads-alerts
SLACK_NOTIFICATIONS_ENABLED=false

# Error tracking
SENTRY_DSN=
SENTRY_ENABLED=false

###############################################################################
# Performance and Scaling
###############################################################################

# Concurrency limits
N8N_CONCURRENCY_PRODUCTION_LIMIT=10
N8N_SKIP_WEBHOOK_DEREGISTRATION_SHUTDOWN=false

# Memory limits
NODE_OPTIONS=--max-old-space-size=2048

###############################################################################
# Development Settings
###############################################################################

# Enable development mode features
N8N_DEV_MODE=false
N8N_DEV_RELOAD=false

###############################################################################
# Backup and Disaster Recovery
###############################################################################

# Backup directory
N8N_BACKUP_DIR=/home/node/.n8n/backups

# Automatic backups
N8N_AUTO_BACKUP=true
N8N_BACKUP_INTERVAL=daily

###############################################################################
# Notes
###############################################################################
# 1. Change all default passwords and secrets before production use
# 2. Generate secure encryption key: openssl rand -hex 32
# 3. For production, use proper SMTP credentials
# 4. Configure proper backup strategy
# 5. Set up monitoring and alerting
# 6. Use reverse proxy (nginx/traefik) for SSL/TLS
